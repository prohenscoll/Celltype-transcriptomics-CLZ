# üìÅ 3_deconvolution

This folder contains all analyses related to **cell-type deconvolution** performed to validate the enrichment of immunopanned bulk RNA-seq samples.

Deconvolution was performed using:
- Three independent single-cell RNA-seq reference datasets
- Two complementary methods: **CIBERSORTx** and **NNLS**

---

## üîç Overview

Deconvolution was carried out in three main steps:

1. **Construction of single-cell reference matrices**
2. **Cell-type deconvolution**
3. **Analysis of estimated cell-type proportions**

---

## 1. Single-cell reference construction

Location: `01_sc_references/`

Single-cell RNA-seq datasets used:
- Zeisel et al., 2015
- Tasic et al., 2018
- Yao et al., 2021

Scripts:
- `01_scReferenceFromZeisel2015.Rmd`
- `02_scReferenceFromTasic2018.Rmd`
- `03_scReferenceFromYao2021.Rmd`

Each script generates a cell-type‚Äìspecific reference expression matrix used for downstream deconvolution.

---

## 2. Cell-type deconvolution

### CIBERSORTx

- Signature matrices were generated using the **CIBERSORTx web platform**.
- Deconvolution was performed externally via the CIBERSORTx interface.
- Resulting signature matrices and proportion estimates are stored in:
  - `02_cibersortx/signature_matrices/`

### NNLS

Location: `03_nnls/`

Script:
- `04_NNLS_deconvolution.Rmd`

NNLS deconvolution was performed locally in R using the same signature matrices generated by CIBERSORTx.

---

## 3. Proportion analysis

Location: `04_proportions_analysis/`

Scripts:
- `05_CIBERSORTx_proportionsanalysis.Rmd`
- `06_NNLS_proportionsanalysis.Rmd`

These scripts analyze and visualize estimated cell-type proportions across samples, treatments, and methods.

---
